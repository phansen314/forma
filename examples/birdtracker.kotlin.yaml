# BirdTracker — Kotlin Target Profile
#
# Satellite document for birdtracker.forma
# Controls how the core model maps to Kotlin code.

target: kotlin

globals:
  package: com.example.birdtracker.model
  immutability: full
  nullability: strict
  collections:
    library: kotlinx-immutable
    collection: PersistentList       # default for [T] (= coll<T>)
    association: PersistentMap        # default for {K, V} (= dict<K, V>)
    custom_wrappers:
      tree: com.example.collections.Tree
  serialization: kotlinx-serialization

type_mappings:
  UUID: java.util.UUID
  string: String
  text: String
  int: Int
  float: Double
  bool: Boolean
  datetime: kotlinx.datetime.Instant
  date: kotlinx.datetime.LocalDate
  json: kotlinx.serialization.json.JsonElement

shapes:
  default:
    style: data_class
    implements: []
    annotations: []
  overrides:
    Bird:
      annotations: ["@Serializable"]
      implements: [Identifiable]
    Observation:
      annotations: ["@Serializable"]

choices:
  default: enum_class
  # enum_class    → for all-bare choices (enum-like)
  # sealed_class  → for fielded choices (union-like)
  overrides:
    Habitat: bitmask

atoms:
  default: typealias
  overrides:
    BirdId: value_class
    UserId: value_class

interfaces:
  Identifiable:
    properties:
      id: UUID
