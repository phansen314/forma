# BirdTracker â€” Kotlin Target Profile
#
# Satellite document for birdtracker.forma
# Controls how the core model maps to Kotlin code.

target: kotlin

generators:
  model:
    package: com.example.birdtracker.model
    immutability: full
    nullability: strict
    collections:
      library: kotlinx-immutable
      collection: PersistentList       # default for [T] (= coll<T>)
      association: PersistentMap        # default for {K, V} (= dict<K, V>)
      custom_wrappers:
        tree: com.example.collections.Tree
    serialization: kotlinx-serialization

type_mappings:
  UUID: java.util.UUID
  string: String
  text: String
  int: Int
  float: Double
  bool: Boolean
  datetime: kotlinx.datetime.Instant
  date: kotlinx.datetime.LocalDate
  json: kotlinx.serialization.json.JsonElement

emitters:
  model:
    default:
      shape: data_class
      choice: enum_class
      atom: typealias

    Bird:
      annotations: ["@Serializable"]
      implements: [Identifiable]
    Observation:
      annotations: ["@Serializable"]

    Habitat:
      style: bitmask

    BirdId:
      style: value_class
    UserId:
      style: value_class

interfaces:
  Identifiable:
    properties:
      id: UUID
